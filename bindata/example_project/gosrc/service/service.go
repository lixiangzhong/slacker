//Generated by slacker
package service

import (
	"crypto/md5"
	"encoding/hex"
	"errors"
	"{{.ProjectName}}/gosrc/dao"
	"github.com/jmoiron/sqlx"
	"{{.ProjectName}}/gosrc/models/{{.UserTable.Name}}"
)

 
type Service struct {
	dao *dao.Dao
}

func New(db *sqlx.DB) *Service {
	d:=dao.New(db)
	d.Init()
	s:= &Service{
		dao: d,
	}
	s.init()
	return s
}

func (s *Service)init()  {
	{{if .HasUserTable}}
user:={{.UserTable.LowerName}}.{{.UserTable.CamelCaseName}}{
	{{.UserTable.UsernameColumn.CamelCaseName}}:"admin",
	{{.UserTable.PasswordColumn.CamelCaseName}}:"admin",
} 
s.Create{{.UserTable.CamelCaseName}}(&user)
{{end}}
}

func MD5(s string) string {
	m := md5.New()
	m.Write([]byte(s))
	return hex.EncodeToString(m.Sum(nil))
}